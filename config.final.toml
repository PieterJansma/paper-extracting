[llm]
base_url = "http://127.0.0.1:8080/v1"
model    = "numind/NuExtract-2.0-8B"
api_key  = "sk-local"
use_grammar = false
max_tokens = 6000
temperature = 0.0

[pdf]
path = "data/concrete.pdf"
max_pages = 40

# =============================================================================
# OPTIMIZED CONFIGURATION 
# =============================================================================

# ---------- PASS A: Overview ----------
[task_overview]
template_json = """
{
  "pid": "string|null",
  "name": "string|null",
  "local_name": "string|null",
  "acronym": "string|null",
  "type": ["string"],
  "type_other": "string|null",
  "cohort_type": "string|null",
  "website": "string|null",
  "description": "string|null",
  "keywords": ["string"],
  "internal_identifiers": [
    {
      "identifier": "string",
      "type": "string|null",
      "type_other": "string|null"
    }
  ],
  "external_identifiers": [
    {
      "identifier": "string",
      "type": "string|null",
      "type_other": "string|null"
    }
  ],
  "start_year": "integer|null",
  "end_year": "integer|null",
  "contact_email": "string|null",
  "issued": "string|null",
  "modified": "string|null"
}
"""

instructions = """
Extract exact resource-level values only (HRICore "General information"). Do NOT infer.

SCOPE
- Describe the RESOURCE as a whole (cohort/registry/biobank).
- Do NOT extract subpopulations here.
- Use ONLY information explicitly stated in the PDF.

GLOBAL RULES
- No placeholders ("Unknown", "N/A", "Not specified").
- If not explicitly stated → null or [].
- Empty strings are NOT allowed.
- Do NOT reuse values across fields unless explicitly stated.

--------------------------------------------------
pid / name / local_name / acronym
--------------------------------------------------
- pid:
  Only if an explicit persistent identifier is stated (e.g. registry ID, trial ID, DOI).
  Do NOT use acronym as pid.

- name:
  Only if the text explicitly labels a resource name (e.g. "<name> study/cohort/registry").
  Article title alone ≠ resource name.

- local_name:
  Only if explicitly stated as a local or participant-facing name.

- acronym:
  Only if explicitly marked as acronym OR a single-token abbreviation (no spaces).

--------------------------------------------------
type (STRICT dropdown)
--------------------------------------------------
Allowed values for type (exact strings only):
- "Biobank"
- "Catalogue"
- "Clinical trial"
- "Cohort study"
- "Databank"
- "Network"
- "Rare disease"
- "Common data model"
- "Data source"
- "Disease specific"
- "Health records"
- "Registry"
- "Other type"

Rules:
- Add a value ONLY if the paper explicitly uses that label.
- Do NOT infer from study design.
- If no allowed value is explicitly stated → [].
- If the resource type does not match any allowed value:
  → type = ["Other type"]
  → fill type_other with the exact wording from the text.

--------------------------------------------------
type_other
--------------------------------------------------
- Fill ONLY if type includes "Other type".
- Must contain verbatim wording from the paper describing the resource type.
- If type does NOT include "Other type" → type_other = null.

--------------------------------------------------
cohort_type (ONLY if type includes "Cohort study")
--------------------------------------------------
Allowed values (exact strings only):
- "Clinical cohort"
- "Population cohort"
- "Case-control"
- "Case only"
- "Birth cohort"
- "Other type"

Rules:
- Fill ONLY if "Cohort study" ∈ type[].
- Only choose a value if explicitly stated.
- Do NOT map or guess.
- If cohort_type = "Other type":
  → append exact wording to description (verbatim).

--------------------------------------------------
website / description / keywords
--------------------------------------------------
- website:
  Only if an explicit URL is present.

- description:
  Only if the paper explicitly describes the resource.
  Do NOT summarize or paraphrase.

- keywords:
  Only if explicitly listed as keywords or resource keywords.
  Must appear verbatim in the text.
  If none → [].

--------------------------------------------------
Identifiers (STRICT lists)
--------------------------------------------------
GENERAL:
- Do NOT invent identifiers.
- Return [] if no identifier value is explicitly present.

EXTERNAL IDENTIFIERS
Allowed values for external_identifiers.type:
- "EUPAS number"
- "METc number"
- "ClinicalTrials.gov"
- "NCT number"
- "EUDRACT number"

Rules:
- If identifier type matches one of the above → set type.
- Otherwise:
  → type = null
  → type_other = exact wording from the text.

INTERNAL IDENTIFIERS
Allowed values for internal_identifiers.type:
- "UMCG register Utopia"
- "UMCG PaNaMaID"

Rules:
- Same logic as external identifiers.
- Do NOT guess based on formatting.

--------------------------------------------------
Dates / contact
--------------------------------------------------
- start_year:
  Integer year ONLY if explicitly tied to start wording ("started in YYYY", "established in YYYY").

- end_year:
  Integer year ONLY if explicitly tied to end wording ("ended in YYYY", "from YYYY to YYYY").

- contact_email:
  Only if explicitly shown.

- issued / modified:
  Only if explicitly stated as resource metadata dates (NOT article publication date).
"""

# ---------- PASS B: Design & structure (Resources) ----------
[task_design_structure]
template_json = """
{
  "design": "string|null",
  "design_description": "string|null",
  "data_collection_type": "string|null"
}
"""

instructions = """
Return ONLY valid JSON matching the template. No extra text. Ensure all quotes are closed.

Extract ONLY explicit values from the PDF. Do NOT infer.

SCOPE
- Resources → "design and structure":
  - design
  - design_description
  - data_collection_type
- Ignore EVERYTHING else (subpopulations, population, eligibility, samples, collection events, follow-up schedules).
- Do NOT output "design schematic" (file upload field).

GLOBAL RULES
- No placeholders ("Unknown", "N/A", "Not specified").
- If not explicitly stated -> null.
- Use ONLY the allowed dropdown values exactly as written below.

--------------------------------------------------
design (STRICT dropdown; single select)
--------------------------------------------------
Allowed values (exact strings only):
- "Longitudinal"
- "Cross-sectional"

Rules:
- Fill ONLY if the paper explicitly uses "longitudinal" or "cross-sectional".
- Do NOT infer from follow-up visits, repeated measures, baseline + follow-up, or prospective wording.
- Do NOT infer cross-sectional from "baseline" unless explicitly called cross-sectional.
- If not explicit -> null.

--------------------------------------------------
design_description (free text)
--------------------------------------------------
- Fill ONLY if the paper explicitly provides a short description of the study design in words.
- Prefer verbatim or near-verbatim wording (max 250 characters).
- Do NOT write your own summary.
- If not explicit -> null.

--------------------------------------------------
data_collection_type (STRICT dropdown; single select)
--------------------------------------------------
Allowed values (exact strings only):
- "Retrospective"
- "Prospective"

Rules:
- Fill ONLY if explicitly stated as retrospective OR prospective.
- If the paper explicitly says BOTH apply:
  -> set data_collection_type = null (do NOT guess which is primary).
- Do NOT infer "Prospective" from "cohort" or "longitudinal".
- Do NOT infer "Retrospective" from use of existing records unless explicitly stated.
- If not explicit -> null.
"""



# ---------- PASS C: Subpopulations ----------
[task_subpopulations]
template_json = """
{
  "subpopulations": [
    {
      "pid": "string|null",
      "description": "string",
      "keywords": ["string"],
      "number_of_participants": "integer|null",
      "counts": [
        {
          "year": "integer|null",
          "age_group": "string|null",
          "gender": "string|null",
          "n_unique_individuals": "integer|null"
        }
      ],
      "inclusion_start": "integer|null",
      "inclusion_end": "integer|null",
      "age_groups": ["string"],
      "age_min": "integer|null",
      "age_max": "integer|null",
      "main_medical_condition": ["string"],
      "comorbidity": ["string"],
      "countries": ["verbatim-string"],
      "regions": ["verbatim-string"],
      "inclusion_criteria": ["string"],
      "other_inclusion_criteria": ["string"],
      "exclusion_criteria": ["string"],
      "other_exclusion_criteria": ["string"],
      "issued": "string|null",
      "modified": "string|null",
      "theme": ["string"],
      "access_rights": "string",
      "applicable_legislation": ["string"]
    }
  ]
}
"""

instructions = """
Extract explicitly defined subpopulations only (arms/subcohorts/strata/case-control/derivation-validation). Do NOT infer.
If none are explicitly defined -> {"subpopulations": []}.

Rules:
- pid: only if explicitly stated for the subpopulation; else null. Do NOT invent.
- description (required): 1–3 sentences describing the subpopulation using paper wording; no inference.
- keywords (required): 5–12 terms to improve findability; try NOT to reuse words from description; no generic filler.
- number_of_participants: subgroup N only if explicitly stated; else null.
- counts: return [] unless the paper explicitly provides unique individual counts by year AND age group AND gender (no partials).
- inclusion_start/inclusion_end: explicit calendar years for this subpopulation only; ongoing -> inclusion_end null.
- age_groups: only if explicitly listed; else [].
- age_min/age_max: integers only if explicit; “≥X” -> age_min=X, age_max=null.
- main_medical_condition/comorbidity: list explicit disease groups/codes or named comorbidities only; no code inference.
- countries/regions: only if explicitly tied to this subpopulation; normalize "The Netherlands"->"Netherlands".
- inclusion/exclusion criteria: only if explicitly applied to this subpopulation (or explicitly stated “same as study criteria”).
- issued/modified: only if explicit publish/last modified dates for the subpopulation data; else null.
- theme (required): must include "Health". Allowed: "Health","Agriculture","Environment","Energy","Government and public sector".
- access_rights (required): "Open access" if explicitly public; "Restricted access" if explicitly controlled; else default "Non public".
- applicable_legislation (required): must include "Data Governance Act" plus any explicitly named laws.
No placeholders ("Unknown/N/A/Not specified"). Use null or [].
"""

# ---------- PASS D: Collection events (CollectionEvents) ----------
[task_collection_events]
template_json = """
{
  "collection_events": [
    {
      "name": "string",
      "pid": "string|null",
      "description": "string",
      "subpopulations": ["string"],
      "keywords": ["string"],
      "start_date": "string|null",
      "end_date": "string|null",
      "age_groups": ["string"],
      "number_of_participants": "integer|null",
      "areas_of_information": ["string"],
      "sample_categories": ["string"],
      "data_categories": ["string"],
      "data_categories_other": "string|null",
      "standardized_tools": ["string"],
      "standardized_tools_other": "string|null",
      "core_variables": ["string"],
      "issued": "string|null",
      "modified": "string|null",
      "theme": ["string"],
      "access_rights": "string",
      "applicable_legislation": ["string"]
    }
  ]
}
"""

instructions = """
Return ONLY valid JSON matching the template. No extra text. Ensure all quotes are closed.

Extract Collection Events (HRICore CollectionEvents). Do NOT infer.

SCOPE
- A "collection event" is a distinct data-collection moment/wave/round/visit (e.g., baseline, follow-up, questionnaire wave).
- Extract ONLY events explicitly described in the paper.
- If no explicit events are described -> {"collection_events": []}.

GLOBAL RULES
- No placeholders ("Unknown", "N/A", "Not specified"). Use null or [].
- Do NOT invent events.
- Use paper wording as much as possible (verbatim or near-verbatim).

--------------------------------------------------
name (REQUIRED)
--------------------------------------------------
- Use explicit event labels from the paper (e.g., "baseline", "6-month follow-up", "T0", "visit 1").
- If an event is clearly described but unnamed, you MAY create a minimal label using ONLY explicit timing wording (e.g., "Baseline", "Follow-up at 6 months").
- If you cannot produce a label from explicit wording -> do not output that event.

--------------------------------------------------
pid
--------------------------------------------------
- Only if an explicit persistent identifier for the event is stated; else null.

--------------------------------------------------
description (REQUIRED)
--------------------------------------------------
- 1–3 sentences describing what is collected/done in this event, using paper wording.
- No inference.

--------------------------------------------------
subpopulations
--------------------------------------------------
- List subpopulations targeted by THIS collection event ONLY if explicitly stated.
- Do NOT infer.
- If not explicit -> [].

--------------------------------------------------
keywords (REQUIRED)
--------------------------------------------------
- 5–12 terms to improve findability of THIS collection event.
- Must be verbatim terms from the paper (no invented synonyms).
- No generic filler.

--------------------------------------------------
start_date / end_date
--------------------------------------------------
- Fill ONLY if explicitly stated for this event (as written).
- Ongoing -> end_date null.
- Do NOT infer from recruitment periods or publication dates.

--------------------------------------------------
age_groups
--------------------------------------------------
- Only fill if the paper explicitly names age group categories or clearly restricts the event to such groups.
- Do NOT infer from mean/median age.
- If not explicit -> [].

--------------------------------------------------
number_of_participants
--------------------------------------------------
- Only if the paper explicitly gives the N for THIS event/wave.
- Do NOT reuse total cohort size.
- Else null.

--------------------------------------------------
areas_of_information (STRICT UI top-level categories)
--------------------------------------------------
Allowed values (exact strings only; top-level categories):
- "Socio-demographic and economic characteristics"
- "Lifestyle and behaviours"
- "Birth, pregnancy and reproductive health history"
- "Perception of health, quality of life, development and functional limitations"
- "Symptoms and signs"
- "Medication and supplements"
- "Non-pharmacological interventions"
- "Health and community care services utilization"
- "Death"
- "Physical measures and assessments"
- "Laboratory measures"
- "Cognition, personality and psychological measures and assessments"
- "Life events, life plans, beliefs and values"
- "Preschool, school and work life"
- "Social environment and relationships"
- "Physical environment"
- "Administrative information"

Rules:
- Add a category ONLY if the paper explicitly states that this type of information was collected in THIS event
  OR explicitly lists measures/variables that clearly fall under one of these categories.
- Prefer top-level categories only; do NOT output subcategory labels.
- Do NOT infer categories from general cohort descriptions.
- If not explicit -> [].

--------------------------------------------------
sample_categories
--------------------------------------------------
- List biological sample types/categories for THIS event ONLY if explicitly stated.
- If not explicitly stated -> [].

--------------------------------------------------
data_categories
--------------------------------------------------
Use ONLY these exact strings if explicitly supported by the paper:
- "Biological samples"
- "Survey data"
- "Imaging data"
- "Medical records"
- "National registries"
- "Genealogical records"
- "Physiological/Biochemical measurements"
- "Genomics"
- "Transcriptomics"
- "Proteomics"
- "Metabolomics"
- "Other"

Rules:
- Add items ONLY if explicitly stated for this event.
- If "Other" is included -> fill data_categories_other with exact wording from the paper.
- Otherwise data_categories_other = null.
- If not explicit -> [].

--------------------------------------------------
standardized_tools / standardized_tools_other
--------------------------------------------------
- standardized_tools: list explicit questionnaire/instrument/tool names used in THIS event.
- Do NOT invent.
- standardized_tools_other must be null unless standardized_tools includes "Other".
- If no explicit tools -> [] and standardized_tools_other = null.

--------------------------------------------------
core_variables
--------------------------------------------------
- List 10–20 variable names ONLY if the paper explicitly lists them for this event.
- If not explicitly enumerated -> [] (do NOT guess).

--------------------------------------------------
issued / modified
--------------------------------------------------
- Only if explicitly stated for this collection event's data; else null.
- Do NOT infer from article publication date.

--------------------------------------------------
theme
--------------------------------------------------
Allowed values:
- "Health"
- "Agriculture"
- "Environment"
- "Energy"
- "Government and public sector"

Rules:
- Must include "Health" for health events. If nothing else explicit -> ["Health"].

--------------------------------------------------
access_rights
--------------------------------------------------
Allowed values:
- "Open access"
- "Restricted access"
- "Non public"

Rules:
- "Open access" ONLY if data are explicitly publicly available.
- "Restricted access" ONLY if explicitly stated controlled/restricted.
- Otherwise default "Non public".

--------------------------------------------------
applicable_legislation
--------------------------------------------------
- Must always include "Data Governance Act".
- Add other laws ONLY if explicitly named (e.g., GDPR/AVG).
- Do NOT include ethics guidelines.
"""


# ---------- PASS E: Population (Resource-level) ----------
[task_population]
template_json = """
{
  "number_of_participants": "integer|null",
  "number_of_participants_with_samples": "integer|null",
  "countries": ["verbatim-string"],
  "regions": ["verbatim-string"],
  "population_age_groups": ["string"],
  "age_min": "integer|null",
  "age_max": "integer|null",
  "inclusion_criteria": ["string"],
  "other_inclusion_criteria": ["string"],
  "exclusion_criteria": ["string"],
  "other_exclusion_criteria": ["string"],
  "population_disease": ["string"],
  "population_oncology_topology": ["string"],
  "population_oncology_morphology": ["string"]
}
"""

instructions = """
Return ONLY valid JSON matching the template. No extra text. Ensure all quotes are closed.

Extract ONLY RESOURCE-LEVEL population information (the overall cohort/registry population).
Do NOT extract subpopulations/arms/strata here (those belong to PASS C).
Do NOT extract collection waves/visits (those belong to PASS D).

GLOBAL RULES
- No placeholders ("Unknown", "N/A", "Not specified").
- If not explicitly stated -> null or [].
- Do NOT infer from typical cohort practice, tables of baseline characteristics, or assumptions.
- Do NOT copy values from other passes unless explicitly stated in the PDF.
- Empty strings are NOT allowed.

--------------------------------------------------
number_of_participants
--------------------------------------------------
Definition: total number of individuals for which data is collected (resource-level).
Rules:
- Use ONLY if the paper explicitly states a total cohort/registry N (e.g., "N=...", "included ... participants").
- Do NOT reuse event-level N (baseline visit N, follow-up N).
- If multiple totals exist (e.g., different timepoints), pick ONLY the one explicitly described as the overall cohort size;
  otherwise return null.

--------------------------------------------------
number_of_participants_with_samples
--------------------------------------------------
Definition: number of individuals for which biological samples were collected (resource-level).
Rules:
- Only fill if BOTH:
  (1) at least one biospecimen type is explicitly mentioned (e.g., blood, saliva, urine, tissue, DNA),
  AND (2) the paper explicitly states how many individuals provided/had samples collected/stored.
- Do NOT infer from "biobank" wording or from total N.
- If not explicit -> null.

--------------------------------------------------
countries / regions
--------------------------------------------------
- countries:
  Include ONLY countries explicitly stated as origin of data/samples for this resource.
  Normalize "The Netherlands" -> "Netherlands".
- regions:
  Include ONLY explicitly stated geographical regions/provinces/cities relevant to where data/samples originate.
  Use verbatim wording (no harmonization beyond obvious Netherlands normalization above).
- If none explicit -> [].

--------------------------------------------------
population_age_groups (STRICT dropdown labels)
--------------------------------------------------
Allowed values (exact strings only):
- "Prenatal"
- "All ages"
- "Infant (0-23 months)"
- "Newborn (0-1 months)"
- "Infants and toddlers (2-23 months)"
- "Child (2-12 years)"
- "Adolescent (13-17 years)"
- "Adult (18+ years)"
- "Young adult (18-24 years)"
- "Adult (25-44 years)"
- "Middle-aged (45-64 years)"
- "Aged (65+ years)"
- "Aged (65-79 years)"
- "Aged (80+ years)"

Rules:
- Add a value ONLY if the paper explicitly indicates the population includes that age group category
  (either by naming the category or by explicitly stating an age range that maps unambiguously to one of these labels).
- Do NOT infer "Adult (18+ years)" just because mean age > 18 unless explicitly restricted.
- If not explicit -> [].

--------------------------------------------------
age_min / age_max
--------------------------------------------------
- age_min:
  Integer ONLY if explicitly stated as minimum age (e.g. "≥18 years", "aged 0–5", "older than 16").
  For "≥X" -> age_min=X.
- age_max:
  Integer ONLY if explicitly stated as maximum age (e.g. "≤80 years", "aged 0–5", "under 18").
  For "≤Y" -> age_max=Y.
- If only "≥X" is given -> age_max=null.
- If only "≤Y" is given -> age_min=null.
- Do NOT infer from mean/median age or SD.
- If not explicit -> null.

--------------------------------------------------
inclusion_criteria / exclusion_criteria (STRICT dropdown values)
--------------------------------------------------
These fields are UI checkbox categories, NOT free-text criteria.
Only output items that are explicitly stated in the paper.

Allowed values (exact strings only) for BOTH inclusion_criteria and exclusion_criteria:
- "Clinically relevant lifestyle inclusion criterion"
- "Family status inclusion criterion"
- "Gravidity inclusion criterion"
- "Use of medication inclusion criterion"
- "Age group inclusion criterion"
- "Health status inclusion criterion"
- "Age of majority inclusion criterion"
- "BMI range inclusion criterion"
- "Country of residence inclusion criteria"
- "Clinically relevant exposure inclusion criterion"
- "Defined population inclusion criterion"
- "Ethnicity inclusion criterion"
- "Hospital patient inclusion criterion"
- "Sex inclusion criterion"

Rules:
- Add a label ONLY if the paper explicitly states that kind of criterion is used.
  Examples:
  - age threshold -> "Age group inclusion criterion"
  - only females/males -> "Sex inclusion criterion"
  - pregnancy/gravidity required -> "Gravidity inclusion criterion"
  - must live in country/region -> "Country of residence inclusion criteria"
  - must be hospital patients -> "Hospital patient inclusion criterion"
- Do NOT infer from demographic descriptions.
- If not explicit -> [].

--------------------------------------------------
other_inclusion_criteria / other_exclusion_criteria
--------------------------------------------------
Free-text lists (paper wording), only if explicit.
Rules:
- Include verbatim or near-verbatim short phrases/sentences from the paper that specify criteria
  that are NOT captured by the checkbox labels above.
- Do NOT invent or summarize.
- If nothing explicit -> [].

--------------------------------------------------
population_disease
--------------------------------------------------
- List diseases/conditions explicitly stated as the target/defined study population (resource-level).
- Use exact wording (include codes if provided).
- If not explicit -> [].

--------------------------------------------------
population_oncology_topology / population_oncology_morphology
--------------------------------------------------
- Only fill if the paper explicitly mentions oncology topology/morphology classifications/codes (e.g., ICD-O terms/codes).
- Do NOT infer oncology just because cancer is mentioned.
- If not explicit -> [].
"""
# ---------- PASS X: Available data & samples (Datasets + Samplesets subtables) ----------
# NOTE: These are SUBTABLES. There can be MULTIPLE entries.
# Output arrays; do NOT assume there is only one dataset/sampleset.

# ---------- PASS X1: Datasets (Datasets table) ----------
[task_datasets]
template_json = """
{
  "datasets": [
    {
      "name": "string",
      "label": "string|null",
      "dataset_type": ["string"],
      "unit_of_observation": "string|null",
      "keywords": ["string"],
      "description": "string|null",
      "number_of_rows": "integer|null",
      "since_version": "string|null",
      "until_version": "string|null"
    }
  ]
}
"""

instructions = """
Return ONLY valid JSON matching the template. No extra text. Do NOT infer.

SCOPE
- Extract entries for the HRICore Datasets subtable (Available data & samples).
- There may be multiple datasets -> return one object per dataset.
- If no dataset is explicitly described -> {"datasets": []}.

GLOBAL RULES
- No placeholders ("Unknown", "N/A", "Not specified").
- If not explicitly stated -> null or [].
- Do NOT invent dataset names, types, versions, counts, or units.
- Do NOT copy values from other passes unless explicitly stated in the PDF.

----------------------------------------
name (REQUIRED)
----------------------------------------
- Use an explicit dataset/table name ONLY if the PDF explicitly names it (e.g., “baseline dataset”, “harmonised dataset X”, “questionnaire dataset”).
- If the PDF does not explicitly name datasets -> return {"datasets": []}.
  (Do NOT create names like "Dataset 1".)

----------------------------------------
label
----------------------------------------
- Short human readable description ONLY if explicitly provided (e.g., a caption-like label).
- Otherwise null. Do NOT write your own summary.

----------------------------------------
dataset_type (STRICT dropdown; multi-select)
----------------------------------------
Allowed values (exact strings only):
- "Collected dataset"
- "Harmonised dataset"
- "Harmonisation schema"

Rules:
- Add a value ONLY if the PDF explicitly uses wording that maps directly to one of these.
- If nothing explicit -> [].

----------------------------------------
unit_of_observation (single select)
----------------------------------------
- Fill ONLY if the PDF explicitly states the unit (e.g., patient, person, sample, prescription/event/observation).
- Otherwise null.
- Do NOT guess from context.

----------------------------------------
keywords
----------------------------------------
- Only if explicitly listed for the dataset OR explicitly stated as tags/topics.
- Must be verbatim terms from the PDF.
- Otherwise [].

----------------------------------------
description
----------------------------------------
- Only if explicitly described as the role/function of this dataset/table (verbatim or near-verbatim).
- Otherwise null.

----------------------------------------
number_of_rows
----------------------------------------
- Only if the PDF explicitly gives the record count for THIS dataset/table.
- Otherwise null.
- Do NOT reuse cohort size as row count.

----------------------------------------
mapped_to / mapped_from
----------------------------------------
- IGNORE these: they are UI fields only fillable after save; do NOT output.

----------------------------------------
since_version / until_version
----------------------------------------
- Only if explicitly stated (as written) for THIS dataset.
- Otherwise null.
- Do NOT infer from paper publication year, software versions, or dates.
"""


# ---------- PASS X2: Samplesets (Samplesets table) ----------
[task_samplesets]
template_json = """
{
  "samplesets": [
    {
      "name": "string",
      "sample_types": ["string"]
    }
  ]
}
"""

instructions = """
Return ONLY valid JSON matching the template. No extra text. Do NOT infer.

SCOPE
- Extract entries for the HRICore Samplesets subtable (Available data & samples).
- There may be multiple sample sets -> return one object per sampleset.
- If no sample sets are explicitly described -> {"samplesets": []}.

GLOBAL RULES
- No placeholders ("Unknown", "N/A", "Not specified").
- If not explicitly stated -> [].
- Do NOT invent sample set names or sample types.

----------------------------------------
name (REQUIRED)
----------------------------------------
- Use an explicit sample set name ONLY if the PDF explicitly names it (e.g., “Blood samples”, “Biobank sampleset”, “DNA collection”).
- If no explicit sampleset name exists -> return {"samplesets": []}.
  (Do NOT create “Sampleset 1”.)

----------------------------------------
sample_types
----------------------------------------
- List biological sample types explicitly mentioned as being part of THIS sampleset (e.g., Blood, Serum, Plasma, Saliva, Urine, Tissue, DNA).
- Use the exact wording from the PDF where possible.
- If the PDF does not list sample types for the named sampleset -> [].
"""


# ---------- PASS X3: Areas of information (Resources field; optional helper) ----------
# (This is the Resources -> "areas of information" multi-select you showed under Available data)
[task_areas_of_information]
template_json = """
{
  "areas_of_information": ["string"]
}
"""

instructions = """
Return ONLY valid JSON matching the template. No extra text. Do NOT infer.

SCOPE
- Extract ONLY the high-level 'areas of information that were collected' if the PDF explicitly states them.
- If not explicitly stated -> {"areas_of_information": []}.

RULES
- Use verbatim terms/categories IF the paper lists them.
- If the paper only gives general statements like “clinical data were collected” without a categorized list -> [].
"""

# ---------- PASS Y: Linkage (Resources → linkage) ----------
[task_linkage]
template_json = """
{
  "prelinked": "boolean|null",
  "linkage_options": "string|null",
  "linkage_possibility": "boolean|null"
}
"""

instructions = """
Return ONLY valid JSON matching the template. No extra text. Do NOT infer.

SCOPE
- Extract RESOURCE-LEVEL linkage information (HRICore → linkage tab).
- This is NOT dataset-level and NOT subpopulation-level.
- Use ONLY information explicitly stated in the PDF.

GLOBAL RULES
- No placeholders ("Unknown", "N/A", "Not specified").
- If not explicitly stated -> null.
- Do NOT assume linkage because registries/databases are mentioned.
- Do NOT assume identifiers imply linkage.

----------------------------------------
prelinked
----------------------------------------
Question:
- "Is the data from this data source linked to other data sources?"

Rules:
- true ONLY if the PDF explicitly states that the data ARE ALREADY LINKED
  (e.g. “data were linked to registry X”, “pre-linked with hospital records”).
- false ONLY if the PDF explicitly states data are NOT linked.
- If linkage status is not explicitly stated -> null.

----------------------------------------
linkage_options
----------------------------------------
Definition:
- Text field describing WHICH external data sources can be linked.

Rules:
- Fill ONLY if the PDF explicitly mentions linkable or linked external resources
  (e.g. named registries, databases, administrative records).
- Use short verbatim or near-verbatim wording.
- Do NOT list variables or outcomes (e.g. mortality, survival).
- If multiple sources are mentioned, combine into a single string separated by "; ".
- If nothing explicit -> null.

----------------------------------------
linkage_possibility
----------------------------------------
Question:
- "Can this data source be linked to other data sources?"

Rules:
- true ONLY if the PDF explicitly states that linkage IS POSSIBLE
  (e.g. “can be linked”, “linkage is possible”, “allows linkage with…”).
- false ONLY if the PDF explicitly states linkage is NOT possible.
- If not explicitly stated -> null.

----------------------------------------
IMPORTANT DISTINCTIONS
----------------------------------------
- Mentioning a registry ≠ linkage.
- Using external data for comparison ≠ linkage.
- Shared governance/network membership ≠ linkage.
- Presence of identifiers ≠ linkage unless explicitly stated.
"""
